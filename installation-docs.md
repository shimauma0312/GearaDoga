# MT5自動売買ツール - 導入とセットアップガイド

## 目次

1. [概要](#概要)
2. [システム要件](#システム要件)
3. [インストール手順](#インストール手順)
4. [設定方法](#設定方法)
5. [起動方法](#起動方法)
6. [戦略の説明](#戦略の説明)
7. [リスク管理](#リスク管理)
8. [トラブルシューティング](#トラブルシューティング)
9. [よくある質問](#よくある質問)

## 概要

このMT5自動売買ツールは、MetaTrader 5（MT5）プラットフォームとPythonを連携させて作動する自動トレードシステムです。移動平均線クロスオーバーやRSIなどのテクニカル指標に基づいた売買シグナルを生成し、設定に基づいて自動的に注文を執行します。

主な特徴：
- 複数の通貨ペアの同時監視
- カスタマイズ可能な戦略パラメータ
- リスク管理機能（ストップロス、テイクプロフィット）
- 詳細なログ記録
- 簡単な設定ファイルによるカスタマイズ

## システム要件

- Windows 10/11 (64ビット)
- Python 3.8以上
- MetaTrader 5プラットフォーム
- 十分なインターネット接続
- MT5の取引口座

### 必要なPythonパッケージ
- MetaTrader5
- pandas
- numpy
- pytz

## インストール手順

### 1. Pythonのインストール

1. [Python公式サイト](https://www.python.org/downloads/)から最新バージョンをダウンロードしてインストール
2. インストール時に「Add Python to PATH」オプションを選択してください

### 2. MetaTrader 5のインストール

1. ご利用のブローカーからMetaTrader 5をダウンロードしてインストール
2. 取引口座でログイン

### 3. 必要なPythonパッケージのインストール

コマンドプロンプトまたはターミナルで以下のコマンドを実行：

```bash
pip install MetaTrader5 pandas numpy pytz
```

### 4. 自動売買ツールのセットアップ

1. このリポジトリからコードファイルをダウンロード
2. 適当なフォルダに配置（例：`C:\trading_bot`）
3. `config.ini`ファイルを作成して設定を記入（以下の「設定方法」セクションを参照）

## 設定方法

`config.ini`ファイルには重要な設定パラメータが含まれています。以下の各セクションを適切に設定してください。

### MT5セクション

```ini
[MT5]
login = 12345678           # MT5のログインID
password = your_password   # MT5のパスワード
server = your_broker_server # ブローカーのサーバー名
```

### トレーディングセクション

```ini
[Trading]
symbols = USDJPY,EURUSD,GBPUSD  # トレード対象の通貨ペア（カンマ区切り）
timeframe = TIMEFRAME_M15       # 時間枠（MT5の定数を使用）
lot_size = 0.1                  # 1取引あたりのロットサイズ
check_interval_seconds = 60     # チェック間隔（秒）
close_positions_on_exit = True  # 終了時にポジションを閉じるかどうか
```

有効な時間枠の例：
- TIMEFRAME_M1 (1分足)
- TIMEFRAME_M5 (5分足)
- TIMEFRAME_M15 (15分足)
- TIMEFRAME_H1 (1時間足)
- TIMEFRAME_H4 (4時間足)
- TIMEFRAME_D1 (日足)

### リスク管理セクション

```ini
[Risk]
max_positions = 5         # 同時に持てるポジションの最大数
stop_loss_pips = 30       # ストップロスのpips数
take_profit_pips = 60     # テイクプロフィットのpips数
```

### 戦略セクション

移動平均線クロスオーバー戦略：

```ini
[Strategy]
name = moving_average_crossover  # 戦略名
fast_ma = 9                      # 短期移動平均線の期間
slow_ma = 21                     # 長期移動平均線の期間
```

RSI戦略：

```ini
[Strategy]
name = rsi                # 戦略名
rsi_period = 14           # RSIの期間
rsi_overbought = 70       # 買われすぎと判断するレベル
rsi_oversold = 30         # 売られすぎと判断するレベル
```

## 起動方法

1. MT5が起動していることを確認
2. MT5にログインしていることを確認
3. コマンドプロンプトまたはターミナルを開き、ボットのディレクトリに移動
4. 以下のコマンドを実行：

```bash
python bot.py
```

正常に起動すると、以下のようなログが表示されます：

```
INFO - MT5に正常に接続しました。アカウント: 12345678
INFO - 残高: 10000.00, 有効証拠金: 10000.00, マージン: 0.00
```

## 戦略の説明

### 移動平均線クロスオーバー戦略

この戦略は、短期移動平均線と長期移動平均線のクロスオーバーに基づいて取引シグナルを生成します。

- **買いシグナル**: 短期移動平均線が長期移動平均線を上回った場合
- **売りシグナル**: 短期移動平均線が長期移動平均線を下回った場合

戦略のパラメーター：
- `fast_ma`: 短期移動平均線の期間（デフォルト: 9）
- `slow_ma`: 長期移動平均線の期間（デフォルト: 21）

### RSI戦略

相対力指数（RSI）に基づく戦略です。RSIが特定のレベルを超えると、市場が買われすぎまたは売られすぎと判断します。

- **買いシグナル**: RSIが設定された「売られすぎ」レベル（例: 30）を下回った場合
- **売りシグナル**: RSIが設定された「買われすぎ」レベル（例: 70）を上回った場合

戦略のパラメーター：
- `rsi_period`: RSIの計算期間（デフォルト: 14）
- `rsi_overbought`: 買われすぎと判断するレベル（デフォルト: 70）
- `rsi_oversold`: 売られすぎと判断するレベル（デフォルト: 30）

## リスク管理

このツールには、以下のリスク管理機能が組み込まれています：

1. **ストップロス**: 各取引に自動的にストップロスを設定。設定したpips数に基づいて計算されます。
2. **テイクプロフィット**: 各取引に自動的にテイクプロフィットを設定。設定したpips数に基づいて計算されます。
3. **最大ポジション数**: 同時に保有できるポジションの最大数を制限します。
4. **ロットサイズ制限**: 取引ごとのロットサイズを固定値に設定します。

**重要**: 自動売買システムを使用する前に、適切なリスク管理設定を行ってください。実際の資金でのトレードを開始する前に、デモ口座でテストすることを強くお勧めします。

## トラブルシューティング

### MT5に接続できない場合

1. MT5が起動しているか確認
2. MT5でログインしているか確認
3. config.iniのログイン情報が正しいか確認
4. MT5のAPIが有効になっているか確認（MT5の「ツール」→「オプション」→「エキスパートアドバイザー」）

### 注文が実行されない場合

1. ログファイル（trading_bot.log）でエラーメッセージを確認
2. ブローカーの取引時間内であるか確認
3. 十分な証拠金があるか確認
4. シンボル名が正しく設定されているか確認

## よくある質問

### Q: 複数の戦略を同時に使用できますか？
A: 現在のバージョンでは、一度に1つの戦略のみ使用できます。設定ファイルで戦略を切り替えることができます。

### Q: 自分でカスタム戦略を追加するにはどうすればいいですか？
A: `calculate_signals`メソッドを拡張して、新しい戦略を実装できます。既存の戦略を参考にしてください。

### Q: バックテストはできますか？
A: 現在のバージョンではリアルタイムトレードのみサポートしています。バックテスト機能は将来のアップデートで追加予定です。

### Q: 複数の口座で同時に実行できますか？
A: 異なる設定ファイルを使用して、複数のインスタンスを起動することで実現できます。

---

**免責事項**: このツールは教育目的で提供されています。実際のトレードにおけるリスクは利用者自身の責任となります。必ずデモ口座でテストしてから実口座での使用を検討してください。
